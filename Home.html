<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NTTF</title>
    <link rel="stylesheet" href="../Css/style.css">
    <link rel="website-icon" type="image" href="">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>
<body>
    <header>
        <div class="container">
            <a href="nec.html" id="nec-link"> 
                <div class="body-container">
                  <img src="nec.jpeg" alt="nec">
                  <h1>Nec</h1>
                </div>
            </a>
              
            <a href="ttc.html" id="ttc-link"> 
                <div class="body-container">
                  <img src="ttc.jpeg" alt="ttc">
                  <h1>TTC</h1>
                </div>
            </a>

            <a href="rntc.html" id="rntc-link"> 
                <div class="body-container">
                    <img src="rntc.jpeg" alt="rntc">
                    <h1>Rntc</h1>
                </div>
            </a>
        </div>
    </header>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const locationChecked = localStorage.getItem('locationChecked');
            if (!locationChecked) {
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(success, error, { maximumAge: 0 });
                } else {
                    console.log("Geolocation is not supported ");
                    updateLinkStyles("nec-link", "none", "0.5");
                    updateLinkStyles("ttc-link", "none", "0.5");
                    updateLinkStyles("rntc-link", "none", "0.5");
                }
            } else {
                const enabledLink = localStorage.getItem('enabledLink');
                const disabledLinks = ["nec-link", "ttc-link", "rntc-link"].filter(id => id !== enabledLink);
                updateLinkStyles(enabledLink, "auto", "1");
                disabledLinks.forEach(linkId => updateLinkStyles(linkId, "none", "0.5"));
            }
        });

//         document.addEventListener("DOMContentLoaded", function() {
//     // Remove locationChecked from local storage on page refresh
//     localStorage.removeItem('locationChecked');

//     const locationChecked = localStorage.getItem('locationChecked');
//     if (!locationChecked) {
//         if (navigator.geolocation) {
//             navigator.geolocation.getCurrentPosition(success, error, { maximumAge: 0 });
//         } else {
//             console.log("Geolocation is not supported ");
//             updateLinkStyles("nec-link", "none", "0.5");
//             updateLinkStyles("ttc-link", "none", "0.5");
//             updateLinkStyles("rntc-link", "none", "0.5");
//         }
//     } else {
//         const enabledLink = localStorage.getItem('enabledLink');
//         const disabledLinks = ["nec-link", "ttc-link", "rntc-link"].filter(id => id !== enabledLink);
//         updateLinkStyles(enabledLink, "auto", "1");
//         disabledLinks.forEach(linkId => updateLinkStyles(linkId, "none", "0.5"));
//     }
// });

        function success(position) {
            const latitude = position.coords.latitude;
            const longitude = position.coords.longitude;
            
            console.log(`Latitude: ${latitude}`);
            console.log(`Longitude: ${longitude}`);
            
            const url = `https://nominatim.openstreetmap.org/reverse?format=json&lat=${latitude}&lon=${longitude}&zoom=18&addressdetails=1`;
            const headers = { 'User-Agent': 'YourApp/1.0' };

            fetch(url, { headers })
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    } else {
                        return response.json();
                    }
                })
                .then(data => {
                    console.log(`Location Details:`);
                    console.log(`Address: ${data.display_name}`);
                    console.log(`City: ${data.address.city}`);
                    console.log(`State: ${data.address.state}`);
                    console.log(`Country: ${data.address.country}`);
                    console.log(`Postal Code: ${data.address.postcode}`);
                    
                    let enabledLink;
                    if (data.address.state === "Jharkhand") {
                        enabledLink = "rntc-link";
                    } else if (data.address.city === "Bangalore" || data.address.state === "Karnataka") {
                        enabledLink = "nec-link";
                    } else if (data.address.state === "Kerala") {
                        enabledLink = "ttc-link";
                    } else {
                        enabledLink = null;
                    }

                    if (enabledLink) {
                        localStorage.setItem('locationChecked', 'true');
                        localStorage.setItem('enabledLink', enabledLink);
                        const disabledLinks = ["nec-link", "ttc-link", "rntc-link"].filter(id => id !== enabledLink);
                        updateLinkStyles(enabledLink, "auto", "1");
                        disabledLinks.forEach(linkId => updateLinkStyles(linkId, "none", "0.5"));
                    } else {
                        console.log("Location not matched for any links.");
                    }
                })
                .catch(error => console.error('Error:', error));
        }

        function updateLinkStyles(id, pointerEvents, opacity) {
            const link = document.getElementById(id);
            if (link) {
                link.style.pointerEvents = pointerEvents;
                link.style.opacity = opacity;

                const mainImg = link.querySelector('img:first-child');
                
                if (mainImg) {
                    if (pointerEvents === 'none') {
                        mainImg.style.filter = 'grayscale(100%)'; // Add grayscale effect to the disabled image
                        mainImg.style.opacity = '0.5'; // Set the opacity of the disabled image to 0.5
                    } else {
                        mainImg.style.filter = 'grayscale(0%)'; // Remove grayscale effect from the enabled image
                        mainImg.style.opacity = '1'; // Set the opacity of the enabled image to 1
                    }
                } else {
                    console.log(`Main image not found for ${id}`);
                }
            } else {
                console.log(`Element with ID ${id} not found`);
            }
        }

        function error(err) {
            console.warn(`ERROR(${err.code}): ${err.message}`);
            updateLinkStyles("nec-link", "none", "0.5");
            updateLinkStyles("ttc-link", "none", "0.5");
            updateLinkStyles("rntc-link", "none", "0.5");
        }
    </script>
    <script src="script.js"></script>
</body>
</html>
